<div class="topic-card" [class.completed]="topic.completed">
  <div class="topic-header" (click)="toggleExpand()">
    <div class="topic-title-section">
      <h3 class="topic-title">{{ topic.title }}</h3>
      <span class="expand-icon" [class.expanded]="isExpanded">▼</span>
    </div>
    <button 
      class="complete-button" 
      [class.completed]="topic.completed"
      (click)="onToggleCompletion(); $event.stopPropagation()"
      title="{{ topic.completed ? 'Mark as Incomplete' : 'Mark as Completed' }}">
      {{ topic.completed ? '✓ Completed' : '○ Mark Complete' }}
    </button>
  </div>

  <div class="topic-content" [class.expanded]="isExpanded">
    <div class="explanation-section">
      <h4>📖 Detailed Explanation</h4>
      <div class="explanation-content" [innerHTML]="topic.explanation"></div>
    </div>

    <div class="examples-section" *ngIf="topic.examples && topic.examples.length > 0">
      <h4>💻 Examples</h4>
      <div class="example" *ngFor="let example of topic.examples">
        <h5>{{ example.title }}</h5>
        <p *ngIf="example.description" class="example-description">{{ example.description }}</p>
        <div class="code-block">
          <button class="copy-button" (click)="copyCode(example.code)" title="Copy code">📋</button>
          <pre><code>{{ example.code }}</code></pre>
        </div>
      </div>
    </div>

    <div class="keypoints-section" *ngIf="topic.keyPoints && topic.keyPoints.length > 0">
      <h4>🔑 Key Points / Summary</h4>
      <ul class="keypoints-list">
        <li *ngFor="let point of topic.keyPoints">{{ point }}</li>
      </ul>
    </div>

    <div class="exercise-section" *ngIf="topic.exercise">
      <h4>✏️ Optional Exercise</h4>
      <div class="exercise-content">
        <h5>{{ topic.exercise.title }}</h5>
        <p>{{ topic.exercise.description }}</p>
        
        <div class="hints" *ngIf="topic.exercise.hints && topic.exercise.hints.length > 0">
          <strong>Hints:</strong>
          <ul>
            <li *ngFor="let hint of topic.exercise.hints">{{ hint }}</li>
          </ul>
        </div>

        <details class="solution" *ngIf="topic.exercise.solution">
          <summary>View Solution</summary>
          <div class="code-block">
            <button class="copy-button" (click)="copyCode(topic.exercise.solution)" title="Copy solution">📋</button>
            <pre><code>{{ topic.exercise.solution }}</code></pre>
          </div>
        </details>
      </div>
    </div>
  </div>
</div>
